cat > watchdog.config.json <<'JSON'
{
  "sudo": {
    "fail_streak_threshold": 3,
    "fail_streak_window_sec": 300,
    "fail_then_success_window_sec": 600,
    "sensitive_cmd_patterns": [
      "useradd|dscl|passwd|chsh",
      "launchctl|crontab",
      "ifconfig|route|pfctl|iptables|ssh-keygen|scp",
      "chmod\\s+-R\\s+7\\d\\d|chown\\s+-R"
    ],
    "no_tty_values": ["?", "unknown", "notty", "none", ""]
  }
}
JSON
